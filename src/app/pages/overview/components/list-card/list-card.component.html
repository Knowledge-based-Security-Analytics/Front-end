<nb-tabset fullWidth>
  <nb-tab tabTitle="Patterns">
    <div class="row">
      <input
        class="search-input"
        nbInput
        fullWidth
        shape="round"
        placeholder="Search..."
        [nbFilterInput]="patternDataSource"
        id="search">
    </div>

    <table [nbTreeGrid]="patternDataSource" [nbSort]="patternDataSource" (sort)="updateSort($event)">
      <tbody>
        <tr nbTreeGridHeaderRow *nbTreeGridHeaderRowDef="allColumns" class="column-header"></tr>
        <tr nbTreeGridRow *nbTreeGridRowDef="let row; columns: allColumns"></tr>

        <ng-container [nbTreeGridColumnDef]="nameColumn">
          <th nbTreeGridHeaderCell [nbSortHeader]="getSortDirection(nameColumn)" *nbTreeGridHeaderCellDef>Name</th>
          <td nbTreeGridCell *nbTreeGridCellDef="let row">{{row.data[nameColumn] || '-'}}</td>
        </ng-container>

        <ng-container [nbTreeGridColumnDef]="deploymentModeColumn">
          <th
            nbTreeGridHeaderCell
            [nbSortHeader]="getSortDirection(deploymentModeColumn)"
            *nbTreeGridHeaderCellDef>
              Deployment Mode
          </th>
          <td nbTreeGridCell *nbTreeGridCellDef="let row" class="deployment-mode-column">
            <nb-icon
              *ngIf="row.data[deploymentModeColumn]==='prod'"
              icon="sun-outline"
              status="success"
              nbTooltip="Production Rule"
              nbTooltipIcon="sun-outline"
              nbTooltipStatus="success"
              nbTooltipPlacement="bottom"></nb-icon>
            <nb-icon
              *ngIf="row.data[deploymentModeColumn]==='dev'"
              icon="settings-outline"
              status="warning"
              nbTooltip="Development Rule"
              nbTooltipIcon="settings-outline"
              nbTooltipStatus="warning"
              nbTooltipPlacement="bottom"></nb-icon>
          </td>
        </ng-container>

        <ng-container [nbTreeGridColumnDef]="actionsColumn">
          <th nbTreeGridHeaderCell *nbTreeGridHeaderCellDef>Actions</th>
          <td nbTreeGridCell *nbTreeGridCellDef="let row">
            <nb-actions size="small" fullWidth>
              <nb-action
                icon="bulb-outline"
                nbTooltip="Information about this Rule"
                nbTooltipIcon="bulb-outline"
                nbTooltipPlacement="bottom"
                (click)="selectStatement(row.data[actionsColumn])">
              </nb-action>
              <nb-action
                icon="edit-outline"
                link="/editor/{{row.data[actionsColumn]}}"
                nbTooltip="Edit this Rule"
                nbTooltipIcon="edit-outline"
                nbTooltipPlacement="bottom">
              </nb-action>
              <nb-action
                icon="trash-2-outline"
                nbTooltip="Delete this Rule"
                nbTooltipIcon="trash-2-outline"
                nbTooltipPlacement="bottom"
                (click)="dropStatement(row.data[actionsColumn], dialog)">
              </nb-action>
            </nb-actions>
          </td>
        </ng-container>
      </tbody>
    </table>
  </nb-tab>

  <nb-tab tabTitle="Schemas">
    <div class="row">
      <input
        class="search-input"
        nbInput
        fullWidth
        shape="round"
        placeholder="Search..."
        [nbFilterInput]="schemaDataSource"
        id="search">
    </div>

    <table [nbTreeGrid]="schemaDataSource" [nbSort]="schemaDataSource" (sort)="updateSort($event)">
      <tbody>
        <tr nbTreeGridHeaderRow *nbTreeGridHeaderRowDef="allColumns" class="column-header"></tr>
        <tr nbTreeGridRow *nbTreeGridRowDef="let row; columns: allColumns"></tr>

        <ng-container [nbTreeGridColumnDef]="nameColumn">
          <th nbTreeGridHeaderCell [nbSortHeader]="getSortDirection(nameColumn)" *nbTreeGridHeaderCellDef>Name</th>
          <td nbTreeGridCell *nbTreeGridCellDef="let row">{{row.data[nameColumn] || '-'}}</td>
        </ng-container>

        <ng-container [nbTreeGridColumnDef]="deploymentModeColumn">
          <th
            nbTreeGridHeaderCell
            [nbSortHeader]="getSortDirection(deploymentModeColumn)"
            *nbTreeGridHeaderCellDef>
              Deployment Mode
          </th>
          <td nbTreeGridCell *nbTreeGridCellDef="let row" class="deployment-mode-column">
            <nb-icon
              *ngIf="row.data[deploymentModeColumn]==='prod'"
              icon="sun-outline"
              status="success"
              nbTooltip="Production Rule"
              nbTooltipIcon="sun-outline"
              nbTooltipStatus="success"
              nbTooltipPlacement="bottom"></nb-icon>
            <nb-icon
              *ngIf="row.data[deploymentModeColumn]==='dev'"
              icon="settings-outline"
              status="warning"
              nbTooltip="Development Rule"
              nbTooltipIcon="settings-outline"
              nbTooltipStatus="warning"
              nbTooltipPlacement="bottom"></nb-icon>
          </td>
        </ng-container>

        <ng-container [nbTreeGridColumnDef]="actionsColumn">
          <th nbTreeGridHeaderCell *nbTreeGridHeaderCellDef>Actions</th>
          <td nbTreeGridCell *nbTreeGridCellDef="let row">
            <nb-actions size="small" fullWidth>
              <nb-action
                icon="bulb-outline"
                nbTooltip="Information about this Rule"
                nbTooltipIcon="bulb-outline"
                nbTooltipPlacement="bottom"
                (click)="selectStatement(row.data[actionsColumn])">
              </nb-action>
              <nb-action
                icon="edit-outline"
                link="/editor/{{row.data[actionsColumn]}}"
                nbTooltip="Edit this Rule"
                nbTooltipIcon="edit-outline"
                nbTooltipPlacement="bottom">
              </nb-action>
              <nb-action
                icon="trash-2-outline"
                nbTooltip="Delete this Rule"
                nbTooltipIcon="trash-2-outline"
                nbTooltipPlacement="bottom"
                (click)="dropStatement(row.data[actionsColumn], dialog)">
              </nb-action>
            </nb-actions>
          </td>
        </ng-container>
      </tbody>
    </table>
  </nb-tab>
</nb-tabset>

<ng-template #dialog let-data let-ref="dialogRef">
  <nb-card class="drop-confirm-dialog" style="min-width: 30rem;">
  <nb-card-header>Do you really want to delete the statement {{ data }}?</nb-card-header>
    <nb-card-footer>
      <div class="row">
        <span class="col-md-1"></span>
        <button nbButton hero shape="round" status="danger" class="col-md-4" (click)="ref.close(false)">
          <nb-icon icon="close-outline"></nb-icon>
          Cancel
        </button>
        <span class="col-md-2"></span>
        <button nbButton hero shape="round" status="success" class="col-md-4" (click)="ref.close(true)">
          <nb-icon icon="checkmark-outline"></nb-icon>
          Confirm
        </button>
        <span class="col-md-1"></span>
      </div>
    </nb-card-footer>
  </nb-card>
</ng-template>
