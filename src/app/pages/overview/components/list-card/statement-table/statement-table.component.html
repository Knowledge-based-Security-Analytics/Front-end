<div class="row">
  <input
    class="search-input"
    nbInput
    fullWidth
    shape="round"
    placeholder="Search for statement..."
    [nbFilterInput]="dataSource"
    id="search">
</div>

<table [nbTreeGrid]="dataSource" [nbSort]="dataSource" (sort)="updateSort($event)" style="border: 2px solid #fff">
  <tbody>
    <tr nbTreeGridHeaderRow *nbTreeGridHeaderRowDef="allColumns" class="column-header"></tr>
    <tr nbTreeGridRow *nbTreeGridRowDef="let row; columns: allColumns"></tr>

    <ng-container [nbTreeGridColumnDef]="nameColumn">
      <th nbTreeGridHeaderCell [nbSortHeader]="getSortDirection(nameColumn)" *nbTreeGridHeaderCellDef style="width: 10rem;">Name</th>
      <td nbTreeGridCell *nbTreeGridCellDef="let row" style="width: 10rem;">
        <nb-actions fullWidth>
          <nb-action
            nbTooltip="Show details"
            nbTooltipIcon="bulb-outline"
            nbTooltipPlacement="bottom"
            (click)="onSelectStatement(row.data[actionsColumn])"
            style="cursor: pointer;">
            {{row.data[nameColumn] || '-'}}
          </nb-action>
        </nb-actions>
      </td>
    </ng-container>

    <ng-container [nbTreeGridColumnDef]="deploymentModeColumn">
      <th
        nbTreeGridHeaderCell
        [nbSortHeader]="getSortDirection(deploymentModeColumn)"
        *nbTreeGridHeaderCellDef>
          Mode
      </th>
      <td nbTreeGridCell *nbTreeGridCellDef="let row" class="deployment-mode-column">
        <nb-icon
          *ngIf="row.data[deploymentModeColumn]==='prod'"
          icon="sun-outline"
          status="success"
          nbTooltip="Production rule"
          nbTooltipIcon="sun-outline"
          nbTooltipStatus="success"
          nbTooltipPlacement="bottom"></nb-icon>
        <nb-icon
          *ngIf="row.data[deploymentModeColumn]==='dev'"
          icon="settings-outline"
          status="warning"
          nbTooltip="Development rule"
          nbTooltipIcon="settings-outline"
          nbTooltipStatus="warning"
          nbTooltipPlacement="bottom"></nb-icon>
      </td>
    </ng-container>

    <ng-container [nbTreeGridColumnDef]="actionsColumn">
      <th nbTreeGridHeaderCell *nbTreeGridHeaderCellDef>Actions</th>
      <td nbTreeGridCell *nbTreeGridCellDef="let row">
        <div class="row">
          <div class="col-md-6 action-container action-container-left">
            <button
            nbButton
            ghost
            status="info"
            nbTooltip="Start editing this rule"
            nbTooltipIcon="edit-outline"
            nbTooltipPlacement="bottom"
            routerLink="/editor/{{row.data[actionsColumn]}}">
              <nb-icon icon="edit-outline"></nb-icon>
            </button>
          </div>
          <div class="col-md-6 action-container action-container-right">
            <button
            nbButton
            ghost
            status="info"
            nbTooltip="Delete this rule"
            nbTooltipIcon="trash-2-outline"
            nbTooltipPlacement="bottom"
            (click)="onDropStatement(row.data[actionsColumn], dialog)">
              <nb-icon icon="trash-2-outline"></nb-icon>
            </button>
          </div>
        </div>
      </td>
    </ng-container>
  </tbody>
</table>

<ng-template #dialog let-data let-ref="dialogRef">
  <nb-card class="drop-confirm-dialog" style="min-width: 30rem;">
  <nb-card-header>Do you really want to delete the statement {{ data }}?</nb-card-header>
    <nb-card-footer>
      <div class="row">
        <span class="col-md-1"></span>
        <button nbButton hero shape="round" status="danger" class="col-md-4" (click)="ref.close(false)">
          <nb-icon icon="close-outline"></nb-icon>
          Cancel
        </button>
        <span class="col-md-2"></span>
        <button nbButton hero shape="round" status="success" class="col-md-4" (click)="ref.close(true)">
          <nb-icon icon="checkmark-outline"></nb-icon>
          Confirm
        </button>
        <span class="col-md-1"></span>
      </div>
    </nb-card-footer>
  </nb-card>
</ng-template>
